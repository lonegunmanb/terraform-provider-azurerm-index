package github.com/hashicorp/terraform-provider-azurerm/internal/provider/framework
import (
	"context"
	"encoding/base64"
	"fmt"
	"os"
	"strings"

	"github.com/hashicorp/terraform-plugin-framework/types"
)
func getClientSecret(d *ProviderModel) (*string, error) {
	clientSecret := strings.TrimSpace(getEnvStringIfValueAbsent(d.ClientSecret, "ARM_CLIENT_SECRET"))

	if path := d.ClientSecretFilePath.ValueString(); path != "" {
		fileSecretRaw, err := os.ReadFile(path)
		if err != nil {
			return nil, fmt.Errorf("reading Client Secret from file %q: %v", path, err)
		}

		fileSecret := strings.TrimSpace(string(fileSecretRaw))

		if clientSecret != "" && clientSecret != fileSecret {
			return nil, fmt.Errorf("mismatch between supplied Client Secret and supplied Client Secret file contents - please either remove one or ensure they match")
		}

		clientSecret = fileSecret
	}

	return &clientSecret, nil
}
