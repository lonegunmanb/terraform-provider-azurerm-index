package github.com/hashicorp/terraform-provider-azurerm/internal/services/mssql/helper
import (
	"github.com/hashicorp/go-azure-helpers/lang/pointer"
	"github.com/hashicorp/go-azure-sdk/resource-manager/sql/2023-08-01-preview/backupshorttermretentionpolicies"
	"github.com/hashicorp/go-azure-sdk/resource-manager/sql/2023-08-01-preview/longtermretentionpolicies"
	"github.com/hashicorp/terraform-provider-azurerm/helpers/validate"
	"github.com/hashicorp/terraform-provider-azurerm/internal/tf/pluginsdk"
	"github.com/hashicorp/terraform-provider-azurerm/internal/tf/validation"
)
func FlattenLongTermRetentionPolicy(input *longtermretentionpolicies.LongTermRetentionPolicy) []interface{} {
	if input == nil {
		return []interface{}{}
	}

	monthlyRetention := "PT0S"
	if input.Properties.MonthlyRetention != nil {
		monthlyRetention = pointer.From(input.Properties.MonthlyRetention)
	}

	weeklyRetention := "PT0S"
	if input.Properties.WeeklyRetention != nil {
		weeklyRetention = pointer.From(input.Properties.WeeklyRetention)
	}

	weekOfYear := int64(1)
	if input.Properties.WeekOfYear != nil && pointer.From(input.Properties.WeekOfYear) != 0 {
		weekOfYear = pointer.From(input.Properties.WeekOfYear)
	}

	yearlyRetention := "PT0S"
	if input.Properties.YearlyRetention != nil {
		yearlyRetention = *input.Properties.YearlyRetention
	}

	return []interface{}{
		map[string]interface{}{
			"monthly_retention": monthlyRetention,
			"weekly_retention":  weeklyRetention,
			"week_of_year":      weekOfYear,
			"yearly_retention":  yearlyRetention,
		},
	}
}
