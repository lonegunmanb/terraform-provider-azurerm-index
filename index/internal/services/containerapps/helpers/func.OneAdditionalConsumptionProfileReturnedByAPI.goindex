package github.com/hashicorp/terraform-provider-azurerm/internal/services/containerapps/helpers
import (
	"github.com/hashicorp/go-azure-helpers/lang/pointer"
	"github.com/hashicorp/go-azure-sdk/resource-manager/containerapps/2025-07-01/managedenvironments"
	"github.com/hashicorp/terraform-provider-azurerm/internal/tf/pluginsdk"
	"github.com/hashicorp/terraform-provider-azurerm/internal/tf/validation"
)
func OneAdditionalConsumptionProfileReturnedByAPI(returnedProfiles, definedProfiles *pluginsdk.Set) bool {
	// if 1 more profile is returned by the API than is defined, then check if it is a consumption profile
	if returnedProfiles.Len() == definedProfiles.Len()+1 {
		// check if we have defined a consumption profile
		for _, v := range definedProfiles.List() {
			profile := v.(map[string]interface{})
			if profile["workload_profile_type"].(string) == string(WorkloadProfileSkuConsumption) {
				return false
			}
		}

		// now that we know there are no consumption profiles defined in the config, check if the API returned a consumption profile
		for _, v := range returnedProfiles.List() {
			profile := v.(map[string]interface{})
			if profile["workload_profile_type"].(string) == string(WorkloadProfileSkuConsumption) {
				return true
			}
		}
	}
	return false
}
