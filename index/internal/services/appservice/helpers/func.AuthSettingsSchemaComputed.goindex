package github.com/hashicorp/terraform-provider-azurerm/internal/services/appservice/helpers
import (
	"fmt"
	"math"
	"strings"

	"github.com/hashicorp/go-azure-helpers/lang/pointer"
	"github.com/hashicorp/go-azure-helpers/resourcemanager/commonids"
	"github.com/hashicorp/go-azure-sdk/resource-manager/web/2023-12-01/webapps"
	"github.com/hashicorp/terraform-plugin-sdk/v2/helper/schema"
	"github.com/hashicorp/terraform-provider-azurerm/internal/services/appservice/validate"
	"github.com/hashicorp/terraform-provider-azurerm/internal/tf/pluginsdk"
	"github.com/hashicorp/terraform-provider-azurerm/internal/tf/validation"
	"github.com/hashicorp/terraform-provider-azurerm/utils"
)
func AuthSettingsSchemaComputed() *pluginsdk.Schema {
	return &pluginsdk.Schema{
		Type:     pluginsdk.TypeList,
		Computed: true,
		Elem: &pluginsdk.Resource{
			Schema: map[string]*pluginsdk.Schema{
				"enabled": {
					Type:        pluginsdk.TypeBool,
					Computed:    true,
					Description: "Is the Authentication / Authorization feature enabled?",
				},

				"additional_login_parameters": {
					Type:     pluginsdk.TypeMap,
					Computed: true,
					Elem: &pluginsdk.Schema{
						Type: pluginsdk.TypeString,
					},
					Description: "The map of Login Parameters sent to the OpenID Connect authorization endpoint when a user logs in.",
				},

				"allowed_external_redirect_urls": {
					Type:     pluginsdk.TypeList,
					Computed: true,
					Elem: &pluginsdk.Schema{
						Type: pluginsdk.TypeString,
					},
					Description: "Specifies a list of External URLs that can be redirected to as part of logging in or logging out of the Windows Web App.",
				},

				"default_provider": {
					Type:        pluginsdk.TypeString,
					Computed:    true,
					Description: "The default authentication provider used when multiple providers are configured. Possible values include: `AzureActiveDirectory`, `Facebook`, `Google`, `MicrosoftAccount`, `Twitter`, `Github`.",
				},

				"issuer": {
					Type:        pluginsdk.TypeString,
					Computed:    true,
					Description: "The OpenID Connect Issuer URI that represents the entity which issues access tokens.",
				},

				"runtime_version": {
					Type:        pluginsdk.TypeString,
					Computed:    true,
					Description: "The RuntimeVersion of the Authentication / Authorization feature in use.",
				},

				"token_refresh_extension_hours": {
					Type:        pluginsdk.TypeFloat,
					Computed:    true,
					Description: "The number of hours after session token expiration that a session token can be used to call the token refresh API.",
				},

				"token_store_enabled": {
					Type:        pluginsdk.TypeBool,
					Computed:    true,
					Description: "Are platform-specific security tokens that are obtained during login flows durably stored?",
				},

				"unauthenticated_client_action": {
					Type:        pluginsdk.TypeString,
					Computed:    true,
					Description: "The action taken when an unauthenticated client attempts to access the app.",
				},

				"active_directory": AadAuthSettingsSchemaComputed(),

				"facebook": FacebookAuthSettingsSchemaComputed(),

				"github": GithubAuthSettingsSchemaComputed(),

				"google": GoogleAuthSettingsSchemaComputed(),

				"microsoft": MicrosoftAuthSettingsSchemaComputed(),

				"twitter": TwitterAuthSettingsSchemaComputed(),
			},
		},
	}
}
