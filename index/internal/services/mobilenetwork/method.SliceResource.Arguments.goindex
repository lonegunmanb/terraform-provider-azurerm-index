package github.com/hashicorp/terraform-provider-azurerm/internal/services/mobilenetwork
import (
	"context"
	"fmt"
	"regexp"
	"time"

	"github.com/hashicorp/go-azure-helpers/lang/pointer"
	"github.com/hashicorp/go-azure-helpers/lang/response"
	"github.com/hashicorp/go-azure-helpers/resourcemanager/commonschema"
	"github.com/hashicorp/go-azure-helpers/resourcemanager/location"
	"github.com/hashicorp/go-azure-sdk/resource-manager/mobilenetwork/2022-11-01/mobilenetwork"
	"github.com/hashicorp/go-azure-sdk/resource-manager/mobilenetwork/2022-11-01/slice"
	"github.com/hashicorp/terraform-provider-azurerm/internal/features"
	"github.com/hashicorp/terraform-provider-azurerm/internal/sdk"
	"github.com/hashicorp/terraform-provider-azurerm/internal/tf/pluginsdk"
	"github.com/hashicorp/terraform-provider-azurerm/internal/tf/validation"
)
func (r SliceResource) Arguments() map[string]*pluginsdk.Schema {
	s := map[string]*pluginsdk.Schema{
		"name": {
			Type:         pluginsdk.TypeString,
			Required:     true,
			ForceNew:     true,
			ValidateFunc: validation.StringIsNotEmpty,
		},

		"mobile_network_id": {
			Type:         pluginsdk.TypeString,
			Required:     true,
			ForceNew:     true,
			ValidateFunc: mobilenetwork.ValidateMobileNetworkID,
		},

		"description": {
			Type:         pluginsdk.TypeString,
			Optional:     true,
			ValidateFunc: validation.StringIsNotEmpty,
		},

		"location": commonschema.Location(),

		"slice_service_type": {
			Type:         pluginsdk.TypeInt,
			Required:     true,
			ValidateFunc: validation.IntBetween(0, 255),
		},

		"slice_differentiator": {
			Type:     pluginsdk.TypeString,
			Optional: true,
			ValidateFunc: validation.StringMatch(
				regexp.MustCompile(`^[A-Fa-f0-9]{6}$`),
				"Slice Differentiator must be a 6 digit hex string",
			),
		},

		"tags": commonschema.Tags(),
	}

	if !features.FivePointOh() {
		s["slice_service_type"] = &pluginsdk.Schema{
			Type:          pluginsdk.TypeInt,
			Optional:      true,
			Computed:      true,
			ValidateFunc:  validation.IntBetween(0, 255),
			ConflictsWith: []string{"single_network_slice_selection_assistance_information"},
		}

		s["slice_differentiator"] = &pluginsdk.Schema{
			Type:     pluginsdk.TypeString,
			Optional: true,
			Computed: true,
			ValidateFunc: validation.StringMatch(
				regexp.MustCompile(`^[A-Fa-f0-9]{6}$`),
				"Slice Differentiator must be a 6 digit hex string",
			),
			ConflictsWith: []string{"single_network_slice_selection_assistance_information"},
		}

		s["single_network_slice_selection_assistance_information"] = &pluginsdk.Schema{
			Type:          pluginsdk.TypeList,
			Optional:      true,
			Computed:      true,
			ConflictsWith: []string{"slice_service_type", "slice_differentiator"},
			MaxItems:      1,
			Deprecated:    "`single_network_slice_selection_assistance_information` has been deprecated and its properties, `slice_differentiator` and `slice_service_type` have been moved to the top level. The `single_network_slice_selection_assistance_information` block will be removed in v5.0 of the AzureRM Provider.",
			Elem: &pluginsdk.Resource{
				Schema: map[string]*pluginsdk.Schema{
					"slice_differentiator": {
						Type:       pluginsdk.TypeString,
						Optional:   true,
						Deprecated: "`single_network_slice_selection_assistance_information` has been deprecated and its properties, `slice_differentiator` and `slice_service_type` have been moved to the top level. The `single_network_slice_selection_assistance_information` block will be removed in v5.0 of the AzureRM Provider.",
						ValidateFunc: validation.StringMatch(
							regexp.MustCompile(`^[A-Fa-f0-9]{6}$`),
							"Slice Differentiator must be a 6 digit hex string",
						),
					},

					"slice_service_type": {
						Type:         pluginsdk.TypeInt,
						Required:     true,
						Deprecated:   "`single_network_slice_selection_assistance_information` has been deprecated and its properties, `slice_differentiator` and `slice_service_type` have been moved to the top level. The `single_network_slice_selection_assistance_information` block will be removed in v5.0 of the AzureRM Provider.",
						ValidateFunc: validation.IntBetween(0, 255),
					},
				},
			},
		}
	}

	return s
}
