package github.com/hashicorp/terraform-provider-azurerm/internal/services/compute/parse
import (
	"fmt"
	"strings"

	"github.com/hashicorp/go-azure-helpers/resourcemanager/resourceids"
	"github.com/hashicorp/go-azure-sdk/resource-manager/compute/2022-03-03/galleryapplicationversions"
	"github.com/hashicorp/go-azure-sdk/resource-manager/compute/2024-03-01/virtualmachines"
)
func VirtualMachineGalleryApplicationAssignmentID(input string) (VirtualMachineGalleryApplicationAssignmentId, error) {
	splitId := strings.Split(input, "|")
	if len(splitId) != 2 {
		return VirtualMachineGalleryApplicationAssignmentId{}, fmt.Errorf("expected ID to be in the format {VirtualMachineId}|{GalleryApplicationVersionId} but got %q", input)
	}

	virtualMachineId, err := virtualmachines.ParseVirtualMachineID(splitId[0])
	if err != nil {
		return VirtualMachineGalleryApplicationAssignmentId{}, err
	}

	galleryApplicationVersionId, err := galleryapplicationversions.ParseApplicationVersionID(splitId[1])
	if err != nil {
		return VirtualMachineGalleryApplicationAssignmentId{}, err
	}

	if virtualMachineId == nil || galleryApplicationVersionId == nil {
		return VirtualMachineGalleryApplicationAssignmentId{}, fmt.Errorf("parse error, both VirtualMachineId and GalleryApplicationVersionId should not be nil")
	}

	return VirtualMachineGalleryApplicationAssignmentId{
		VirtualMachineId:            *virtualMachineId,
		GalleryApplicationVersionId: *galleryApplicationVersionId,
	}, nil
}
